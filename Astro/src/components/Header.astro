---
// Header.astro - Navegación principal
import LogoWebp from '../assets/images/Logo.webp';
import LogoPng from '../assets/images/Logo.png';
---

<header id="header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300">
    <div class="container mx-auto px-6 py-4">
        <div class="flex items-center justify-between">
            <!-- Logo -->
            <div class="flex items-center">
                <picture>
                    <source srcset={LogoWebp.src} type="image/webp">
                    <img src={LogoPng.src} alt="Controllers RD Logo" class="h-12 object-contain">
                </picture>
                <span class="ml-3 text-xl font-cinzel font-bold text-gray-800">Controllers RD</span>
            </div>
            
            <!-- Desktop Navigation -->
            <nav class="hidden md:flex space-x-8">
                <a href="#inicio" class="nav-link text-gray-600 hover:text-blue-600 font-medium">Inicio</a>
                <a href="#sobre-nosotros" class="nav-link text-gray-600 hover:text-blue-600 font-medium">Sobre Nosotros</a>
                <a href="#servicios" class="nav-link text-gray-600 hover:text-blue-600 font-medium">Servicios</a>
                <a href="#valores" class="nav-link text-gray-600 hover:text-blue-600 font-medium">Valores</a>
                <a href="#contacto" class="nav-link text-gray-600 hover:text-blue-600 font-medium">Contacto</a>
            </nav>
            
            <!-- CTA Button Desktop -->
            <div class="hidden md:block">
                <a href="#contacto" class="bg-blue-600 text-white hover:bg-blue-700 transition-all duration-300 font-medium py-2 px-5 rounded-full shadow-lg hover:shadow-blue-700/50 btn-primary">
                    Contacto
                </a>
            </div>
            
            <!-- Mobile Menu Button -->
            <button id="mobile-menu-button" class="md:hidden text-gray-600 hover:text-blue-600 focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>
        
        <!-- Mobile Navigation -->
        <nav id="mobile-menu" class="md:hidden mt-4 hidden">
            <div class="flex flex-col space-y-2 bg-white rounded-lg shadow-lg p-4">
                <a href="#inicio" class="block py-2 text-gray-600 hover:text-blue-600 mobile-nav-link">Inicio</a>
                <a href="#sobre-nosotros" class="block py-2 text-gray-600 hover:text-blue-600 mobile-nav-link">Sobre Nosotros</a>
                <a href="#servicios" class="block py-2 text-gray-600 hover:text-blue-600 mobile-nav-link">Servicios</a>
                <a href="#valores" class="block py-2 text-gray-600 hover:text-blue-600 mobile-nav-link">Valores</a>
                <a href="#contacto" class="block py-2 text-gray-600 hover:text-blue-600 mobile-nav-link">Contacto</a>
            </div>
        </nav>
    </div>
</header>

<script>
  // Manejar scroll del header
  function handleHeaderScroll() {
    const header = document.getElementById('header');
    if (window.scrollY > 50) {
      header?.classList.add('scrolled');
    } else {
      header?.classList.remove('scrolled');
    }
  }

  // Manejar menú móvil
  function setupMobileMenu() {
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');

    mobileMenuButton?.addEventListener('click', () => {
      mobileMenu?.classList.toggle('hidden');
    });

    // Cerrar menú al hacer click en un enlace
    mobileNavLinks.forEach(link => {
      link.addEventListener('click', () => {
        mobileMenu?.classList.add('hidden');
      });
    });

    // Cerrar menú al hacer click fuera
    document.addEventListener('click', (event) => {
      const target = event.target as Element;
      if (!mobileMenuButton?.contains(target) && !mobileMenu?.contains(target)) {
        mobileMenu?.classList.add('hidden');
      }
    });
  }

  // Scroll suave para los enlaces
  function setupSmoothScroll() {
    const navLinks = document.querySelectorAll('a[href^="#"]');
    
    navLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const href = link.getAttribute('href');
        if (href) {
          const target = document.querySelector(href) as HTMLElement;
          if (target) {
            const headerHeight = document.getElementById('header')?.offsetHeight || 0;
            const targetPosition = target.offsetTop - headerHeight - 20;
            
            window.scrollTo({
              top: targetPosition,
              behavior: 'smooth'
            });
          }
        }
      });
    });
  }

  // Inicializar funcionalidades
  document.addEventListener('DOMContentLoaded', () => {
    setupMobileMenu();
    setupSmoothScroll();
    handleHeaderScroll(); // Check initial state
  });

  // Escuchar scroll
  window.addEventListener('scroll', handleHeaderScroll);
</script>